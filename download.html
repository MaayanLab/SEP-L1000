<div class="container-fluid">
	<div class="row">
		<div id="data" class="col-xs-10 col-xs-offset-1">
		</div>
	</div>
</div>
<style type="text/css">
table{
  margin: 0 auto;
  width: 100%;
  clear: both;
  border-collapse: collapse;
  table-layout: fixed;
}

tr {
	text-align: center;
	word-wrap:break-word;
}
th {
	word-wrap: normal; 
}
.left{
	text-align: left;
	padding-left: 0 !important;
}
.copy{
	cursor: pointer;
}
</style>
<script src="js/clipboard.min.js"></script>
<script>
var clipboard = new Clipboard('.copy');
clipboard.on('success', function(e) {
    flashTooltip(e.trigger, 'Copied!');
});

function flashTooltip(elem, msg) {
	// distroy the helper text
	$(elem).tooltip('destroy');
	// show tooltip
    elem.setAttribute('title', msg);
    $(elem).tooltip('show');
    // remote title and tooltip
    setTimeout(function(){
    	$(elem).tooltip('destroy');
    	elem.removeAttribute('title');
    }, 500);
}


$.getJSON('data/download_data.json', function(results){
	var headerLabels = ['Name', 'Description', 'Rows', 'Columns', 'Size(MB)', 'md5', 'Source', 'Reference'];
	var widths = ["20%", "50%", "5%", "5%", "5%", "5%", "5%", "5%"];

    var table = $('<table>').addClass('table table-striped table-hover table-condensed');

    var thead = $('<thead>');
    var tr = $('<tr>')

    $.each(headerLabels,function(i, headerLabel) {
    	var w = widths[i];
        tr.append('<th style="width:' +w+ ';">' + headerLabel + '</th>');
    });

    thead.append(tr)
    table.append(thead);
    $("#data").append(table);
    var columnsDef = [   
    { 
    	"data": "Name",
    	"render": function(data, type, full, meta){
    		return '<a href="'+full['path']+'"download>'+data+'</a>';
    	},
    	"className": "left"
    },
    { 
    	"data": "Description",
    	"className": "left"
    },
    { "data": "Rows"},
    { "data": "Columns"},
    { "data": "Size(MB)"},
    { 
    	"data": "md5",
    	"render": function(data, type, full, meta){
    		var icon = '<span class="glyphicon glyphicon-copy" ></span>';
    		return '<a class="copy" data-toggle="tooltip" title="Click to copy" data-clipboard-text="'+ data +'">' + icon + '</a>';
    	}
    },
    { 
    	"data" : "Source",
    	"render": function(data, type, full, meta){
    		var icon = '<span class="glyphicon glyphicon-share-alt"></span>'
    		if (data) {
    			return '<a target="_blank" data-toggle="tooltip" title="Link to source" href="'+data+'">'+icon+'</a>';	
    		}else{
    			return icon;
    		};
    	},
	},


    { 
        "data": "Reference", 
        "render": function(data, type, full, meta){
        	var icon = '<span class="glyphicon glyphicon-book"></span>'
        	if (data) {
        		return '<a target="_blank" data-toggle="tooltip" title="Link to reference" href="http://www.ncbi.nlm.nih.gov/pubmed/'+data+'">'+icon+'</a>';	
        	}else{
        		return icon;
        	}
        },
    }
    ];

    rctable = table.dataTable({
        "data": results,
        "columns": columnsDef,
        "order": [[0, 'asc']],
        "deferRender": true,
        "bAutoWidth": false,


        // "sDom": 'T<"clear">lfrtip',
        // "oTableTools": {
        //     // to save table
        //     "sSwfPath": "js/swf/copy_csv_xls_pdf.swf",
        //     "aButtons": [
        //     "copy",
        //     "print",
        //     {
        //         "sExtends":    "collection",
        //         "sButtonText": 'Save <span class="caret" />',
        //         "aButtons":    [ "csv", "xls", "pdf" ]
        //     }
        //     ],
        // },
        "fnInitComplete": function(oSettings, json){ //DataTables has finished its initialisation.
            $('[data-toggle="tooltip"]').tooltip();
        },
    });

});




</script>
